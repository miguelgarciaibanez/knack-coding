cb34da8160ea919ce655e7d61b0bbf15
'use strict';

var scopedPackagePattern = new RegExp('^(?:@([^/]+?)[/])?([^/]+?)$');
var builtins = require('builtins');
var blacklist = ['node_modules', 'favicon.ico'];
var validate = module.exports = function (name) {
  var warnings = [];
  var errors = [];
  if (name === null) {
    errors.push('name cannot be null');
    return done(warnings, errors);
  }
  if (name === undefined) {
    errors.push('name cannot be undefined');
    return done(warnings, errors);
  }
  if (typeof name !== 'string') {
    errors.push('name must be a string');
    return done(warnings, errors);
  }
  if (!name.length) {
    errors.push('name length must be greater than zero');
  }
  if (name.match(/^\./)) {
    errors.push('name cannot start with a period');
  }
  if (name.match(/^_/)) {
    errors.push('name cannot start with an underscore');
  }
  if (name.trim() !== name) {
    errors.push('name cannot contain leading or trailing spaces');
  }

  // No funny business
  blacklist.forEach(function (blacklistedName) {
    if (name.toLowerCase() === blacklistedName) {
      errors.push(blacklistedName + ' is a blacklisted name');
    }
  });

  // Generate warnings for stuff that used to be allowed

  // core module names like http, events, util, etc
  builtins.forEach(function (builtin) {
    if (name.toLowerCase() === builtin) {
      warnings.push(builtin + ' is a core module name');
    }
  });

  // really-long-package-names-------------------------------such--length-----many---wow
  // the thisisareallyreallylongpackagenameitshouldpublishdowenowhavealimittothelengthofpackagenames-poch.
  if (name.length > 214) {
    warnings.push('name can no longer contain more than 214 characters');
  }

  // mIxeD CaSe nAMEs
  if (name.toLowerCase() !== name) {
    warnings.push('name can no longer contain capital letters');
  }
  if (/[~'!()*]/.test(name.split('/').slice(-1)[0])) {
    warnings.push('name can no longer contain special characters ("~\'!()*")');
  }
  if (encodeURIComponent(name) !== name) {
    // Maybe it's a scoped package name, like @user/package
    var nameMatch = name.match(scopedPackagePattern);
    if (nameMatch) {
      var user = nameMatch[1];
      var pkg = nameMatch[2];
      if (encodeURIComponent(user) === user && encodeURIComponent(pkg) === pkg) {
        return done(warnings, errors);
      }
    }
    errors.push('name can only contain URL-friendly characters');
  }
  return done(warnings, errors);
};
validate.scopedPackagePattern = scopedPackagePattern;
var done = function (warnings, errors) {
  var result = {
    validForNewPackages: errors.length === 0 && warnings.length === 0,
    validForOldPackages: errors.length === 0,
    warnings: warnings,
    errors: errors
  };
  if (!result.warnings.length) delete result.warnings;
  if (!result.errors.length) delete result.errors;
  return result;
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJzY29wZWRQYWNrYWdlUGF0dGVybiIsIlJlZ0V4cCIsImJ1aWx0aW5zIiwicmVxdWlyZSIsImJsYWNrbGlzdCIsInZhbGlkYXRlIiwibW9kdWxlIiwiZXhwb3J0cyIsIm5hbWUiLCJ3YXJuaW5ncyIsImVycm9ycyIsInB1c2giLCJkb25lIiwidW5kZWZpbmVkIiwibGVuZ3RoIiwibWF0Y2giLCJ0cmltIiwiZm9yRWFjaCIsImJsYWNrbGlzdGVkTmFtZSIsInRvTG93ZXJDYXNlIiwiYnVpbHRpbiIsInRlc3QiLCJzcGxpdCIsInNsaWNlIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwibmFtZU1hdGNoIiwidXNlciIsInBrZyIsInJlc3VsdCIsInZhbGlkRm9yTmV3UGFja2FnZXMiLCJ2YWxpZEZvck9sZFBhY2thZ2VzIl0sInNvdXJjZXMiOlsiaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnXG5cbnZhciBzY29wZWRQYWNrYWdlUGF0dGVybiA9IG5ldyBSZWdFeHAoJ14oPzpAKFteL10rPylbL10pPyhbXi9dKz8pJCcpXG52YXIgYnVpbHRpbnMgPSByZXF1aXJlKCdidWlsdGlucycpXG52YXIgYmxhY2tsaXN0ID0gW1xuICAnbm9kZV9tb2R1bGVzJyxcbiAgJ2Zhdmljb24uaWNvJ1xuXVxuXG52YXIgdmFsaWRhdGUgPSBtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gIHZhciB3YXJuaW5ncyA9IFtdXG4gIHZhciBlcnJvcnMgPSBbXVxuXG4gIGlmIChuYW1lID09PSBudWxsKSB7XG4gICAgZXJyb3JzLnB1c2goJ25hbWUgY2Fubm90IGJlIG51bGwnKVxuICAgIHJldHVybiBkb25lKHdhcm5pbmdzLCBlcnJvcnMpXG4gIH1cblxuICBpZiAobmFtZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgZXJyb3JzLnB1c2goJ25hbWUgY2Fubm90IGJlIHVuZGVmaW5lZCcpXG4gICAgcmV0dXJuIGRvbmUod2FybmluZ3MsIGVycm9ycylcbiAgfVxuXG4gIGlmICh0eXBlb2YgbmFtZSAhPT0gJ3N0cmluZycpIHtcbiAgICBlcnJvcnMucHVzaCgnbmFtZSBtdXN0IGJlIGEgc3RyaW5nJylcbiAgICByZXR1cm4gZG9uZSh3YXJuaW5ncywgZXJyb3JzKVxuICB9XG5cbiAgaWYgKCFuYW1lLmxlbmd0aCkge1xuICAgIGVycm9ycy5wdXNoKCduYW1lIGxlbmd0aCBtdXN0IGJlIGdyZWF0ZXIgdGhhbiB6ZXJvJylcbiAgfVxuXG4gIGlmIChuYW1lLm1hdGNoKC9eXFwuLykpIHtcbiAgICBlcnJvcnMucHVzaCgnbmFtZSBjYW5ub3Qgc3RhcnQgd2l0aCBhIHBlcmlvZCcpXG4gIH1cblxuICBpZiAobmFtZS5tYXRjaCgvXl8vKSkge1xuICAgIGVycm9ycy5wdXNoKCduYW1lIGNhbm5vdCBzdGFydCB3aXRoIGFuIHVuZGVyc2NvcmUnKVxuICB9XG5cbiAgaWYgKG5hbWUudHJpbSgpICE9PSBuYW1lKSB7XG4gICAgZXJyb3JzLnB1c2goJ25hbWUgY2Fubm90IGNvbnRhaW4gbGVhZGluZyBvciB0cmFpbGluZyBzcGFjZXMnKVxuICB9XG5cbiAgLy8gTm8gZnVubnkgYnVzaW5lc3NcbiAgYmxhY2tsaXN0LmZvckVhY2goZnVuY3Rpb24gKGJsYWNrbGlzdGVkTmFtZSkge1xuICAgIGlmIChuYW1lLnRvTG93ZXJDYXNlKCkgPT09IGJsYWNrbGlzdGVkTmFtZSkge1xuICAgICAgZXJyb3JzLnB1c2goYmxhY2tsaXN0ZWROYW1lICsgJyBpcyBhIGJsYWNrbGlzdGVkIG5hbWUnKVxuICAgIH1cbiAgfSlcblxuICAvLyBHZW5lcmF0ZSB3YXJuaW5ncyBmb3Igc3R1ZmYgdGhhdCB1c2VkIHRvIGJlIGFsbG93ZWRcblxuICAvLyBjb3JlIG1vZHVsZSBuYW1lcyBsaWtlIGh0dHAsIGV2ZW50cywgdXRpbCwgZXRjXG4gIGJ1aWx0aW5zLmZvckVhY2goZnVuY3Rpb24gKGJ1aWx0aW4pIHtcbiAgICBpZiAobmFtZS50b0xvd2VyQ2FzZSgpID09PSBidWlsdGluKSB7XG4gICAgICB3YXJuaW5ncy5wdXNoKGJ1aWx0aW4gKyAnIGlzIGEgY29yZSBtb2R1bGUgbmFtZScpXG4gICAgfVxuICB9KVxuXG4gIC8vIHJlYWxseS1sb25nLXBhY2thZ2UtbmFtZXMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tc3VjaC0tbGVuZ3RoLS0tLS1tYW55LS0td293XG4gIC8vIHRoZSB0aGlzaXNhcmVhbGx5cmVhbGx5bG9uZ3BhY2thZ2VuYW1laXRzaG91bGRwdWJsaXNoZG93ZW5vd2hhdmVhbGltaXR0b3RoZWxlbmd0aG9mcGFja2FnZW5hbWVzLXBvY2guXG4gIGlmIChuYW1lLmxlbmd0aCA+IDIxNCkge1xuICAgIHdhcm5pbmdzLnB1c2goJ25hbWUgY2FuIG5vIGxvbmdlciBjb250YWluIG1vcmUgdGhhbiAyMTQgY2hhcmFjdGVycycpXG4gIH1cblxuICAvLyBtSXhlRCBDYVNlIG5BTUVzXG4gIGlmIChuYW1lLnRvTG93ZXJDYXNlKCkgIT09IG5hbWUpIHtcbiAgICB3YXJuaW5ncy5wdXNoKCduYW1lIGNhbiBubyBsb25nZXIgY29udGFpbiBjYXBpdGFsIGxldHRlcnMnKVxuICB9XG5cbiAgaWYgKC9bfichKCkqXS8udGVzdChuYW1lLnNwbGl0KCcvJykuc2xpY2UoLTEpWzBdKSkge1xuICAgIHdhcm5pbmdzLnB1c2goJ25hbWUgY2FuIG5vIGxvbmdlciBjb250YWluIHNwZWNpYWwgY2hhcmFjdGVycyAoXCJ+XFwnISgpKlwiKScpXG4gIH1cblxuICBpZiAoZW5jb2RlVVJJQ29tcG9uZW50KG5hbWUpICE9PSBuYW1lKSB7XG4gICAgLy8gTWF5YmUgaXQncyBhIHNjb3BlZCBwYWNrYWdlIG5hbWUsIGxpa2UgQHVzZXIvcGFja2FnZVxuICAgIHZhciBuYW1lTWF0Y2ggPSBuYW1lLm1hdGNoKHNjb3BlZFBhY2thZ2VQYXR0ZXJuKVxuICAgIGlmIChuYW1lTWF0Y2gpIHtcbiAgICAgIHZhciB1c2VyID0gbmFtZU1hdGNoWzFdXG4gICAgICB2YXIgcGtnID0gbmFtZU1hdGNoWzJdXG4gICAgICBpZiAoZW5jb2RlVVJJQ29tcG9uZW50KHVzZXIpID09PSB1c2VyICYmIGVuY29kZVVSSUNvbXBvbmVudChwa2cpID09PSBwa2cpIHtcbiAgICAgICAgcmV0dXJuIGRvbmUod2FybmluZ3MsIGVycm9ycylcbiAgICAgIH1cbiAgICB9XG5cbiAgICBlcnJvcnMucHVzaCgnbmFtZSBjYW4gb25seSBjb250YWluIFVSTC1mcmllbmRseSBjaGFyYWN0ZXJzJylcbiAgfVxuXG4gIHJldHVybiBkb25lKHdhcm5pbmdzLCBlcnJvcnMpXG59XG5cbnZhbGlkYXRlLnNjb3BlZFBhY2thZ2VQYXR0ZXJuID0gc2NvcGVkUGFja2FnZVBhdHRlcm5cblxudmFyIGRvbmUgPSBmdW5jdGlvbiAod2FybmluZ3MsIGVycm9ycykge1xuICB2YXIgcmVzdWx0ID0ge1xuICAgIHZhbGlkRm9yTmV3UGFja2FnZXM6IGVycm9ycy5sZW5ndGggPT09IDAgJiYgd2FybmluZ3MubGVuZ3RoID09PSAwLFxuICAgIHZhbGlkRm9yT2xkUGFja2FnZXM6IGVycm9ycy5sZW5ndGggPT09IDAsXG4gICAgd2FybmluZ3M6IHdhcm5pbmdzLFxuICAgIGVycm9yczogZXJyb3JzXG4gIH1cbiAgaWYgKCFyZXN1bHQud2FybmluZ3MubGVuZ3RoKSBkZWxldGUgcmVzdWx0Lndhcm5pbmdzXG4gIGlmICghcmVzdWx0LmVycm9ycy5sZW5ndGgpIGRlbGV0ZSByZXN1bHQuZXJyb3JzXG4gIHJldHVybiByZXN1bHRcbn1cbiJdLCJtYXBwaW5ncyI6IkFBQUEsWUFBWTs7QUFFWixJQUFJQSxvQkFBb0IsR0FBRyxJQUFJQyxNQUFNLENBQUMsNkJBQTZCLENBQUM7QUFDcEUsSUFBSUMsUUFBUSxHQUFHQyxPQUFPLENBQUMsVUFBVSxDQUFDO0FBQ2xDLElBQUlDLFNBQVMsR0FBRyxDQUNkLGNBQWMsRUFDZCxhQUFhLENBQ2Q7QUFFRCxJQUFJQyxRQUFRLEdBQUdDLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHLFVBQVVDLElBQUksRUFBRTtFQUM5QyxJQUFJQyxR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